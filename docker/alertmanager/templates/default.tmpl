{{ define "__subject" }}[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}] {{ .GroupLabels.SortedPairs.Values | join " " }} {{ if gt (len .CommonLabels) (len .GroupLabels) }}({{ with .CommonLabels.Remove .GroupLabels.Names }}{{ .Values | join " " }}{{ end }}){{ end }}{{ end }}

{{ define "__text_alert_list" }}{{ range . }}
**Alert:** {{ .Annotations.summary }}
**Description:** {{ .Annotations.description }}
**Severity:** {{ .Labels.severity }}
**Service:** {{ .Labels.service }}
**Instance:** {{ .Labels.instance }}
**Started:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}
{{ if .GeneratorURL }}**Source:** [Prometheus]({{ .GeneratorURL }}){{ end }}
{{ end }}{{ end }}

{{ define "email.default.html" }}
<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; }
        .alert { border-left: 4px solid; padding: 10px; margin: 10px 0; }
        .critical { border-color: #dc3545; background: #f8d7da; }
        .warning { border-color: #ffc107; background: #fff3cd; }
        .info { border-color: #17a2b8; background: #d1ecf1; }
        .resolved { border-color: #28a745; background: #d4edda; }
        .label { display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 12px; }
        .severity-critical { background: #dc3545; color: white; }
        .severity-warning { background: #ffc107; color: black; }
    </style>
</head>
<body>
    <h2>{{ template "__subject" . }}</h2>

    {{ if gt (len .Alerts.Firing) 0 }}
    <h3>ðŸ”¥ Firing Alerts ({{ .Alerts.Firing | len }})</h3>
    {{ range .Alerts.Firing }}
    <div class="alert critical">
        <span class="label severity-critical">CRITICAL</span>
        <strong>{{ .Annotations.summary }}</strong><br>
        {{ .Annotations.description }}<br>
        <small>Service: {{ .Labels.service }} | Instance: {{ .Labels.instance }}</small>
    </div>
    {{ end }}
    {{ end }}

    {{ if gt (len .Alerts.Resolved) 0 }}
    <h3>âœ… Resolved Alerts ({{ .Alerts.Resolved | len }})</h3>
    {{ range .Alerts.Resolved }}
    <div class="alert resolved">
        <span class="label severity-warning">RESOLVED</span>
        <strong>{{ .Annotations.summary }}</strong><br>
        {{ .Annotations.description }}<br>
        <small>Service: {{ .Labels.service }}</small>
    </div>
    {{ end }}
    {{ end }}

    <hr>
    <small>
        Sent by Alertmanager {{ .ExternalURL }}<br>
        Group: {{ .GroupLabels.SortedPairs.Values | join ", " }}
    </small>
</body>
</html>
{{ end }}